import React, { useState, useEffect, useRef } from 'react';
import ReactPlayer from 'react-player';
import Button from '../../common/components/Button';
import { useLocation, useNavigate } from 'react-router-dom';
import { Id, ToastContainer, toast } from 'react-toastify';
import styles from './WorkoutPage.module.scss';
import {
  useCompleteExerciseMutation,
  useCompleteSetMutation,
  useCompleteWorkoutMutation,
  useIncompleteExerciseMutation,
} from '../TrainingPage/api/getTrainee';
import { FaChevronDown } from 'react-icons/fa';
import { MdArrowBackIos } from 'react-icons/md';
import { Tooltip } from 'react-tooltip';

interface PersonalExercise {
  id: number;
  name: string;
  reps: number;
  description: string;
  weight_kg?: number;
  video_url: string;
}

interface PersonalSet {
  personal_workout_id: number;
  id: number;
  color_code: string;
  personal_exercises: PersonalExercise[];
}

interface Workout {
  is_cycle_completed: boolean;
  repetitions: number;
  personal_sets: PersonalSet[];
}

export const WorkoutPage: React.FC = () => {
  const location = useLocation();
  const { workout, workout_date } = location.state as { workout: Workout; workout_date: { id: number } };
  const [showNotificationButton, setShowNotificationButton] = useState(workout.is_cycle_completed);
  const toastIdRef = useRef<Id | null>(null);

  const navigate = useNavigate();
  const [open, setOpen] = useState(false);

  const [completeSet, { isLoading: isCompleting }] = useCompleteSetMutation();
  const [completeWorkout, { isLoading: isCompletingWorkout }] = useCompleteWorkoutMutation();
  const [completeExercise] = useCompleteExerciseMutation();
  const [incompleteExercise] = useIncompleteExerciseMutation();

  const [timer, setTimer] = useState<number>(0);
  const [currentSetIndex, setCurrentSetIndex] = useState<number>(0);
  const [currentRoundInSet, setCurrentRoundInSet] = useState<number>(0);
  const [weight, setWeight] = useState<string>('');
  const [isCompleted, setIsCompleted] = useState<boolean>(false);

  const currentSet = workout.personal_sets[currentSetIndex];

  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≤ —Å–µ—Ç–µ
  const exercisesCount = currentSet.personal_exercises.length;

  // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ —Å–µ—Ç–µ = —Å—É–º–º–∞ –≤—Å–µ—Ö reps
  const totalRepsInSet = currentSet.personal_exercises.reduce((sum, ex) => sum + ex.reps, 0);

  // –ù–∞—Ö–æ–¥–∏–º —Ç–µ–∫—É—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ, –ø—Ä–æ–ø—É—Å–∫–∞—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
  let currentExerciseIndex = currentRoundInSet % exercisesCount;
  let currentRound = Math.floor(currentRoundInSet / exercisesCount);

  // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
  let attempts = 0;
  while (attempts < exercisesCount && currentRound >= currentSet.personal_exercises[currentExerciseIndex].reps) {
    currentRoundInSet++;
    currentExerciseIndex = currentRoundInSet % exercisesCount;
    currentRound = Math.floor(currentRoundInSet / exercisesCount);
    attempts++;
  }

  const currentExercise = currentSet.personal_exercises[currentExerciseIndex];

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏ —Ç–µ–∫—É—â–∏–π —Ä–∞—É–Ω–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ reps –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
  const isExerciseCompleted = currentRound >= currentExercise.reps;

  // –ü–æ–¥—Å—á–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (—É—á–∏—Ç—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ)
  let currentRepNumber = 0;
  for (let i = 0; i <= currentRoundInSet; i++) {
    const exIndex = i % exercisesCount;
    const round = Math.floor(i / exercisesCount);
    const exercise = currentSet.personal_exercises[exIndex];
    if (round < exercise.reps) {
      currentRepNumber++;
    }
  }

  // –°–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω –∫–æ–≥–¥–∞ currentRepNumber –¥–æ—Å—Ç–∏–≥ totalRepsInSet
  const isSetCompleted = currentRepNumber >= totalRepsInSet;
  const isLastSet = currentSetIndex === workout.personal_sets.length - 1;

  const timerRef = useRef(null);

  const radius = 63.75;
  const circumference = 2 * Math.PI * radius;

  // –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ —Å–µ—Ç–µ
  const repProgress = (currentRepNumber / totalRepsInSet) * 100;
  const repStrokeDashoffset = circumference - (repProgress / 100) * circumference;

  const notificationText =
    '–ù–∞ —ç—Ç–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ —Å–ª–µ–¥—É–µ—Ç –ø–æ–¥–Ω—è—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É —Å –ø–æ–º–æ—â—å—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç—è–≥–æ—â–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ —Å–¥–µ–ª–∞–π—Ç–µ –ø–æ–¥—ä–µ–º –Ω–∞ –æ–¥–∏–Ω —à–∞–≥ –≤ –≤–µ—Å–µ –≤ –∫–∞–∂–¥–æ–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏. –ï—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ –í—ã –Ω–µ —Å–º–æ–∂–µ—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π —Å –Ω–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, —Ç–æ –æ—Å—Ç–∞–≤—å—Ç–µ –¥–ª—è —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Å–∞. –ï—Å–ª–∏ —É –í–∞—Å –ø–æ—è–≤—è—Ç—å—Å—è –∫–∞–∫–∏–µ-–ª–∏–±–æ –≤–æ–ø—Ä–æ—Å—ã, —Ç–æ —Å–ª–µ–¥—É–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —Ç—Ä–µ–Ω–µ—Ä—É.';

  const showNotification = () => {
    if (toastIdRef.current) {
      toast.dismiss(toastIdRef.current);
    }

    toastIdRef.current = toast(notificationText, {
      autoClose: 5000,
      closeButton: true,
      draggable: false,
      position: 'bottom-right',
      onClose: () => {
        setShowNotificationButton(true);
      },
    });

    setShowNotificationButton(false);
  };

  useEffect(() => {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    timerRef.current = setInterval(() => {
      setTimer(prev => prev + 1);
    }, 1000);

    return () => {
      if (timerRef.current) {
        clearInterval(timerRef.current);
      }
    };
  }, []);

  const formatTime = (seconds: number) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  };

  const handleComplete = async () => {
    try {
      // –í—ã–ø–æ–ª–Ω—è–µ–º API –∑–∞–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
      if (!isExerciseCompleted) {
        await completeExercise({
          exerciseId: currentExercise.id,
          weight: weight ? Number(weight) : undefined,
        }).unwrap();
      }

      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞—É–Ω–¥—É
      let nextRound = currentRoundInSet + 1;

      // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
      let nextExIndex = nextRound % exercisesCount;
      let nextRoundNum = Math.floor(nextRound / exercisesCount);
      let skipped = 0;

      while (skipped < exercisesCount && nextRoundNum >= currentSet.personal_exercises[nextExIndex].reps) {
        nextRound++;
        nextExIndex = nextRound % exercisesCount;
        nextRoundNum = Math.floor(nextRound / exercisesCount);
        skipped++;
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —Å–µ—Ç
      let completedCount = 0;
      for (let i = 0; i <= nextRound; i++) {
        const exIndex = i % exercisesCount;
        const round = Math.floor(i / exercisesCount);
        const exercise = currentSet.personal_exercises[exIndex];
        if (round < exercise.reps) {
          completedCount++;
        }
      }

      if (completedCount >= totalRepsInSet) {
        await completeSet(currentSet.id).unwrap();

        // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–µ—Ç
        if (isLastSet) {
          await completeWorkout(workout_date.id).unwrap();
          toast.success('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
          if (timerRef.current) clearInterval(timerRef.current);
          setIsCompleted(true);
          setTimeout(() => navigate('/calendar'), 3000);
          return;
        } else {
          // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–µ—Ç—É
          setCurrentSetIndex(prev => prev + 1);
          setCurrentRoundInSet(0);
        }
      } else {
        setCurrentRoundInSet(nextRound);
      }

      setWeight('');
    } catch {
      toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ');
    }
  };

  const handleSkip = async () => {
    try {
      if (!isExerciseCompleted) {
        await incompleteExercise({ exerciseId: currentExercise.id });
      }

      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞—É–Ω–¥—É
      let nextRound = currentRoundInSet + 1;

      // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
      let nextExIndex = nextRound % exercisesCount;
      let nextRoundNum = Math.floor(nextRound / exercisesCount);
      let skipped = 0;

      while (skipped < exercisesCount && nextRoundNum >= currentSet.personal_exercises[nextExIndex].reps) {
        nextRound++;
        nextExIndex = nextRound % exercisesCount;
        nextRoundNum = Math.floor(nextRound / exercisesCount);
        skipped++;
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —Å–µ—Ç
      let completedCount = 0;
      for (let i = 0; i <= nextRound; i++) {
        const exIndex = i % exercisesCount;
        const round = Math.floor(i / exercisesCount);
        const exercise = currentSet.personal_exercises[exIndex];
        if (round < exercise.reps) {
          completedCount++;
        }
      }

      if (completedCount >= totalRepsInSet) {
        if (isLastSet) {
          await completeWorkout(workout_date.id).unwrap();
          toast.success('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
          if (timerRef.current) clearInterval(timerRef.current);
          setIsCompleted(true);
          setTimeout(() => navigate('/calendar'), 3000);
          return;
        } else {
          setCurrentSetIndex(prev => prev + 1);
          setCurrentRoundInSet(0);
        }
      } else {
        setCurrentRoundInSet(nextRound);
      }
    } catch {
      toast.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ');
    }
  };

  useEffect(() => {
    if (currentExercise?.weight_kg) {
      setWeight(String(currentExercise.weight_kg));
    } else {
      setWeight('');
    }
  }, [currentExercise]);

  if (isCompleted) {
    return (
      <div className={styles.container}>
        <div className={styles.completedCard}>
          <h1 className={styles.completedTitle}>üéâ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h1>
          <p className={styles.completedTime}>–í—Ä–µ–º—è: {formatTime(timer)}</p>
        </div>
      </div>
    );
  }

  return (
    <div className={styles.container}>
      <div className={styles.card} style={{ borderColor: currentSet.color_code }}>
        <div className={styles.header}>
          <div />
          <span className={styles.headerTitle}>
            –°–µ—Ç {currentSetIndex + 1}/{workout.personal_sets.length}
          </span>
          <span className={styles.timer}>{formatTime(timer)}</span>
        </div>

        <ReactPlayer controls style={{ width: '100%', height: '35vh' }} src={currentExercise.video_url} />

        <div className={styles.exerciseContainer}>
          <div
            className={styles.exerciseName}
            style={{
              maxHeight: open ? '1200px' : '120px',
            }}
          >
            <p>{currentExercise.name}</p>
            <div
              onClick={() => setOpen(!open)}
              style={{
                cursor: 'pointer',
              }}
            >
              <FaChevronDown
                color='#e2f163'
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  transition: 'transform 0.3s',
                  transform: open ? 'rotate(180deg)' : 'rotate(0deg)',
                }}
              />
            </div>
          </div>
          <div
            style={{
              maxHeight: open ? '200px' : '0',
              overflow: 'auto',
              transition: 'max-height 0.3s ease',
              marginTop: '8px',
            }}
          >
            <p style={{ color: '#8F9AA2', textAlign: 'start', lineHeight: 1.2 }}>{currentExercise.description}</p>
          </div>
        </div>

        <div>
          <p
            style={{
              color: '#8F9AA2',
              marginBottom: '10px',
              marginLeft: '10px',
              fontSize: '14px',
              textAlign: 'start',
              display: 'flex',
              alignItems: 'center',
              gap: '5px',
            }}
          >
            –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤–µ—Å–∞ –≤ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–∏–∂–µ –≤ –∫–≥/lb/—Å–µ–∫
            <span
              className={styles.tooltipIcon}
              data-tooltip-content='–ù–∞ –ø–µ—Ä–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≤–µ—Å –¥–ª—è –≤—Å–µ—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π. –ü—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –Ω–∞ 8-12 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π, –ø–æ–¥–±–µ—Ä–∏—Ç–µ —Ç–∞–∫–æ–π –≤–µ—Å, —á—Ç–æ–±—ã –≤—ã —á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∏ –∑–∞–ø–∞—Å —Å–∏–ª –º–∞–∫—Å–∏–º—É–º –Ω–∞ 1-2 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è, –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –≤ –ø–æ–¥—Ö–æ–¥–µ. –ï—Å–ª–∏ –≤—ã –æ–ø—ã—Ç–Ω—ã–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω, –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ–≤–æ–¥–∏—Ç—å –ø–æ–¥—Ö–æ–¥ –¥–æ "–æ—Ç–∫–∞–∑–∞" –ü—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –Ω–∞ 15-19 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π, –ø–æ–¥–±–µ—Ä–∏—Ç–µ —Ç–∞–∫–æ–π –≤–µ—Å, —á—Ç–æ–±—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5-7 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π –ø–æ–¥—Ö–æ–¥–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç "–∂–∂–µ–Ω–∏—è" –≤ —Ç—Ä–µ–Ω–∏—Ä—É–µ–º—ã—Ö –º—ã—à—Ü–∞—Ö. –î–∞–ª–µ–µ, –∫–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É, –≤–∞–º –ø–æ–¥—Å–∫–∞–∂–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –Ω–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –µ—ë –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç—Ä–µ–Ω–µ—Ä—É.'
              data-tooltip-id='activity-tooltip'
              style={{ flexShrink: 0 }}
            >
              ?
            </span>
          </p>
          <Tooltip
            id='activity-tooltip'
            className={styles.tooltip}
            place='top'
            float={true}
            offset={8}
            positionStrategy='fixed'
          />
          <div className={styles.weightInput}>
            <input
              className={styles.input}
              type='number'
              min={0}
              step={0.5}
              value={weight}
              onChange={(e: React.ChangeEvent<HTMLInputElement>) => setWeight(e.currentTarget.value)}
            />
          </div>
        </div>
        <div style={{ display: 'flex', justifyContent: 'space-around' }}>
          {/* üîµ –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ —Å–µ—Ç–µ */}
          <div className={styles.progressContainer}>
            <svg className={styles.progressRing} width='150' height='150'>
              <circle className={styles.progressRingBackground} cx='75' cy='75' r='63.75' />
              <circle
                className={styles.progressRingCircle}
                cx='75'
                cy='75'
                r='63.75'
                strokeDasharray={circumference}
                strokeDashoffset={repStrokeDashoffset}
              />
            </svg>
            <div className={styles.progressContent}>
              <p style={{ fontSize: '14px', position: 'absolute', top: '-15px', color: '#666', lineHeight: 0.7 }}>
                –ø–æ–¥—Ö–æ–¥—ã
              </p>
              <div className={styles.setCounter}>
                {currentRepNumber}/{totalRepsInSet}
              </div>
            </div>
          </div>

          {/* üü¢ –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è */}
          <div className={styles.progressContainer}>
            <svg className={styles.progressRing} width='150' height='150'>
              <circle cx='75' cy='75' r={radius} className={styles.progressRingBackground} />
              <circle
                cx='75'
                cy='75'
                r={radius}
                className={styles.progressRingCircleEx}
                strokeDasharray={circumference}
              />
            </svg>

            <div className={styles.progressContent}>
              <p style={{ fontSize: '14px', position: 'absolute', top: '-15px', color: '#666', lineHeight: 0.7 }}>
                –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
              </p>
              <div className={styles.setCounter}>{workout.repetitions}</div>
            </div>
          </div>
        </div>

        <div className={styles.progressInfo}>
          <div className={styles.infoLabel}>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ—Ç–¥—ã—Ö–∞—Ç—å 2-3 –º–∏–Ω—É—Ç—ã –º–µ–∂–¥—É –ø–æ–¥—Ö–æ–¥–∞–º–∏</div>
        </div>

        <div className={styles.actions}>
          <Button onClick={handleComplete} disabled={isCompleting || isCompletingWorkout}>
            {isSetCompleted ? '–°–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω' : '–ü–æ–¥—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω'}
          </Button>

          <Button buttonType='secondary' onClick={handleSkip}>
            –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
          </Button>
        </div>
      </div>
      <ToastContainer
        theme='light'
        hideProgressBar
        toastStyle={{
          fontSize: '14px',
          lineHeight: '1.5',
          background: '#672dca',
          color: 'white',
        }}
      />
      {showNotificationButton && (
        <button className={styles.notificationButton} onClick={showNotification}>
          <MdArrowBackIos />
        </button>
      )}{' '}
    </div>
  );
};
